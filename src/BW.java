/// TEST code
class Main2 {
  public static void main(String[] args) {
    double[][] a = {{0.09933628313082242, 0.09882379001843108, 0.09923060510281613, 0.10626417127035566, 0.10090651968516905, 0.09674075459111639, 0.10477476617205436, 0.09805000239009441, 0.0981117474371731, 0.09776136020196731}, {0.09359358025292241, 0.10132683032343713, 0.10327548997263027, 0.10319927883991284, 0.10288956474277744, 0.10096502027735016, 0.09629797648015678, 0.0985078400293241, 0.10207924249613076, 0.09786517658535768}, {0.10129278481475788, 0.09832653546677997, 0.10499300531486558, 0.09865941628813239, 0.1042395198810716, 0.09432295530640364, 0.10062390610454709, 0.10413430407004028, 0.09608415178127717, 0.09732342097212483}, {0.10250972748523321, 0.09327121926331866, 0.10163220556579022, 0.10189315226177602, 0.10758521906762801, 0.09697029351178653, 0.10076531138322128, 0.10064001859164726, 0.1000047231970741, 0.09472812967252482}, {0.10057438955357662, 0.09298772761551659, 0.10121652529209266, 0.1000942333402939, 0.10420009017304409, 0.09453290027551924, 0.10248206283778764, 0.09865805670743524, 0.10204499389574496, 0.10320902030898879}, {0.10011118270406971, 0.10226276530821758, 0.10261030242182585, 0.09798529915903109, 0.09560685011143216, 0.10098901847589883, 0.10148284639583353, 0.09872049203065075, 0.10002087562717911, 0.10021036776586123}, {0.10181141542187874, 0.09458500922997946, 0.0941399684511164, 0.10487896534740598, 0.10551317759918104, 0.09915857681159657, 0.09898673828066096, 0.10311447115190936, 0.10253456607413888, 0.09527711163213298}, {0.10165668053265008, 0.0995978549892302, 0.0989542077905202, 0.09943784993214289, 0.10195563950451907, 0.0984416658035674, 0.10033740141870752, 0.09822504154595031, 0.0998135415427144, 0.10158011693999759}, {0.09501837491129173, 0.09301508371193315, 0.10271380968759478, 0.10447451616828345, 0.10700468310606544, 0.09286005399091447, 0.09810276590820718, 0.09923304521808259, 0.10216930640088555, 0.10540836089674227}, {0.0983331803680253, 0.09891521468745657, 0.1013793362613944, 0.10549714191996931, 0.10606890579786088, 0.09351539044192485, 0.10211963704038778, 0.10180049501388097, 0.09639177366776429, 0.09597892480133588}};
    double[][] b = {{0.26047585792939565, 0.09251551349540611, 0.09280052441393095, 0.0001, 0.00001, 0.00001, 0.2853317038002682, 0.19812834428554138, 0.07074805607545763, 0.0001}, {0.2752660955961582, 0.09091740860917358, 0.09358676335594869, 0.000001, 0.00001, 0.0001, 0.2689405105136921, 0.20004848721330046, 0.07124073471172646, 0.001}, {0.259719981594212, 0.08717028086918915, 0.09385064979764235, 0.00001, 0.00001, 0.000001, 0.27650514479458255, 0.21153648459758032, 0.07121745834679412, 0.00001}, {0.2479228355427828, 0.093951735957289, 0.09331134852085944, 0.00001, 0.00001, 0.00001, 0.29385852974357163, 0.19945952676210202, 0.07149602347339516, 0.00001}, {0.24611733645756215, 0.09189108795107609, 0.08615330535400618, 0.00001, 0.0001, 0.0001, 0.2970923028707845, 0.2105068562366768, 0.06823911112989409, 0.0001}, {0.2796926827304025, 0.09013873301589995, 0.0868407193063169, 0.0001, 0.00001, 0.00001, 0.2713289819579095, 0.20089342795965576, 0.07110545502981529, 0.0001}, {0.26504790146243734, 0.09138391842633573, 0.09154511854009828, 0.0001, 0.0001, 0.00001, 0.2917750886550957, 0.1910511904204432, 0.06919678249558991, 0.0001}, {0.2712850445666534, 0.08778330481697848, 0.09021395067189242, 0.0001, 0.0001, 0.00001, 0.27370075947497285, 0.205920285703879, 0.0710966547656236, 0.00001}, {0.25419765291059593, 0.09206683867097924, 0.0938670117539077, 0.00001, 0.0001, 0.00001, 0.28480778412752206, 0.20196667098742171, 0.07309404154957376, 0.0001}, {0.2683394821005164, 0.09119992249801367, 0.08692454047008859, 0.0001, 0.001, 0.0001, 0.283519800319871, 0.20028687567374312, 0.06972937893776747, 0.0001}};
    double[] pi = {1.0000000000000007, 1.0000000000000007, 1.0000000000000007, 1.0000000000000007, 1.0000000000000007, 1.0000000000000007, 1.0000000000000007, 1.0000000000000007, 1.0000000000000007, 1.0000000000000007};
    double[] pi2 =  {1.0000000000000007, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    HMMModel m = new HMMModel(a, b, pi);
//    HMMModel m = new HMMModel(InitializeModel.generateRandomMatrix(), InitializeModel.generateRandomMatrix(), InitializeModel.generateRandomRow(10));
    int[][] o = {{1,1,0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0}, {1,1,0, 1, 1, 1}};
    int[][] o2 = {{0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
    // BaumWelch2 bw = new BaumWelch2(m, o2[0], m.n, m.m);
    // bw.run();
//    System.out.println(Arrays.deepToString(bw.model.a));
    System.out.println(m.logProbForObsSeq(o2[0]));
  }
}
